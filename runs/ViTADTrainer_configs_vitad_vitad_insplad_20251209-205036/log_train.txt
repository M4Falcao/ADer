2025-12-09 20:50:36,694 - ==> Logging on master GPU: 0
2025-12-09 20:50:36,694 - ==> Running Trainer: ViTADTrainer
2025-12-09 20:50:36,694 - ==> Using GPU: [0] for Training
2025-12-09 20:50:36,694 - ==> Building model
2025-12-09 20:50:36,853 - Loading pretrained weights from Hugging Face hub (timm/vit_small_patch16_224.dino)
2025-12-09 20:50:37,581 - HTTP Request: HEAD https://huggingface.co/timm/vit_small_patch16_224.dino/resolve/main/model.safetensors "HTTP/1.1 302 Found"
2025-12-09 20:50:37,587 - [timm/vit_small_patch16_224.dino] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
2025-12-09 20:50:37,625 - Resized position embedding: (14, 14) to (16, 16).
2025-12-09 20:50:38,358 - 
------------------------------------ ViTAD ------------------------------------
| module                            | #parameters or shape   | #flops       |
|:----------------------------------|:-----------------------|:-------------|
| model                             | 38.586M                | 9.668G       |
|  net_t                            |  21.689M               |  5.544G      |
|   net_t.cls_token                 |   (1, 1, 384)          |              |
|   net_t.pos_embed                 |   (1, 257, 384)        |              |
|   net_t.patch_embed.proj          |   0.295M               |   75.497M    |
|    net_t.patch_embed.proj.weight  |    (384, 3, 16, 16)    |              |
|    net_t.patch_embed.proj.bias    |    (384,)              |              |
|   net_t.blocks                    |   21.294M              |   5.469G     |
|    net_t.blocks.0                 |    1.774M              |    0.456G    |
|     net_t.blocks.0.norm1          |     0.768K             |     0.493M   |
|      net_t.blocks.0.norm1.weight  |      (384,)            |              |
|      net_t.blocks.0.norm1.bias    |      (384,)            |              |
|     net_t.blocks.0.attn           |     0.591M             |     0.152G   |
|      net_t.blocks.0.attn.qkv      |      0.444M            |      0.114G  |
|      net_t.blocks.0.attn.proj     |      0.148M            |      37.896M |
|     net_t.blocks.0.norm2          |     0.768K             |     0.493M   |
|      net_t.blocks.0.norm2.weight  |      (384,)            |              |
|      net_t.blocks.0.norm2.bias    |      (384,)            |              |
|     net_t.blocks.0.mlp            |     1.182M             |     0.303G   |
|      net_t.blocks.0.mlp.fc1       |      0.591M            |      0.152G  |
|      net_t.blocks.0.mlp.fc2       |      0.59M             |      0.152G  |
|    net_t.blocks.1                 |    1.774M              |    0.456G    |
|     net_t.blocks.1.norm1          |     0.768K             |     0.493M   |
|      net_t.blocks.1.norm1.weight  |      (384,)            |              |
|      net_t.blocks.1.norm1.bias    |      (384,)            |              |
|     net_t.blocks.1.attn           |     0.591M             |     0.152G   |
|      net_t.blocks.1.attn.qkv      |      0.444M            |      0.114G  |
|      net_t.blocks.1.attn.proj     |      0.148M            |      37.896M |
|     net_t.blocks.1.norm2          |     0.768K             |     0.493M   |
|      net_t.blocks.1.norm2.weight  |      (384,)            |              |
|      net_t.blocks.1.norm2.bias    |      (384,)            |              |
|     net_t.blocks.1.mlp            |     1.182M             |     0.303G   |
|      net_t.blocks.1.mlp.fc1       |      0.591M            |      0.152G  |
|      net_t.blocks.1.mlp.fc2       |      0.59M             |      0.152G  |
|    net_t.blocks.2                 |    1.774M              |    0.456G    |
|     net_t.blocks.2.norm1          |     0.768K             |     0.493M   |
|      net_t.blocks.2.norm1.weight  |      (384,)            |              |
|      net_t.blocks.2.norm1.bias    |      (384,)            |              |
|     net_t.blocks.2.attn           |     0.591M             |     0.152G   |
|      net_t.blocks.2.attn.qkv      |      0.444M            |      0.114G  |
|      net_t.blocks.2.attn.proj     |      0.148M            |      37.896M |
|     net_t.blocks.2.norm2          |     0.768K             |     0.493M   |
|      net_t.blocks.2.norm2.weight  |      (384,)            |              |
|      net_t.blocks.2.norm2.bias    |      (384,)            |              |
|     net_t.blocks.2.mlp            |     1.182M             |     0.303G   |
|      net_t.blocks.2.mlp.fc1       |      0.591M            |      0.152G  |
|      net_t.blocks.2.mlp.fc2       |      0.59M             |      0.152G  |
|    net_t.blocks.3                 |    1.774M              |    0.456G    |
|     net_t.blocks.3.norm1          |     0.768K             |     0.493M   |
|      net_t.blocks.3.norm1.weight  |      (384,)            |              |
|      net_t.blocks.3.norm1.bias    |      (384,)            |              |
|     net_t.blocks.3.attn           |     0.591M             |     0.152G   |
|      net_t.blocks.3.attn.qkv      |      0.444M            |      0.114G  |
|      net_t.blocks.3.attn.proj     |      0.148M            |      37.896M |
|     net_t.blocks.3.norm2          |     0.768K             |     0.493M   |
|      net_t.blocks.3.norm2.weight  |      (384,)            |              |
|      net_t.blocks.3.norm2.bias    |      (384,)            |              |
|     net_t.blocks.3.mlp            |     1.182M             |     0.303G   |
|      net_t.blocks.3.mlp.fc1       |      0.591M            |      0.152G  |
|      net_t.blocks.3.mlp.fc2       |      0.59M             |      0.152G  |
|    net_t.blocks.4                 |    1.774M              |    0.456G    |
|     net_t.blocks.4.norm1          |     0.768K             |     0.493M   |
|      net_t.blocks.4.norm1.weight  |      (384,)            |              |
|      net_t.blocks.4.norm1.bias    |      (384,)            |              |
|     net_t.blocks.4.attn           |     0.591M             |     0.152G   |
|      net_t.blocks.4.attn.qkv      |      0.444M            |      0.114G  |
|      net_t.blocks.4.attn.proj     |      0.148M            |      37.896M |
|     net_t.blocks.4.norm2          |     0.768K             |     0.493M   |
|      net_t.blocks.4.norm2.weight  |      (384,)            |              |
|      net_t.blocks.4.norm2.bias    |      (384,)            |              |
|     net_t.blocks.4.mlp            |     1.182M             |     0.303G   |
|      net_t.blocks.4.mlp.fc1       |      0.591M            |      0.152G  |
|      net_t.blocks.4.mlp.fc2       |      0.59M             |      0.152G  |
|    net_t.blocks.5                 |    1.774M              |    0.456G    |
|     net_t.blocks.5.norm1          |     0.768K             |     0.493M   |
|      net_t.blocks.5.norm1.weight  |      (384,)            |              |
|      net_t.blocks.5.norm1.bias    |      (384,)            |              |
|     net_t.blocks.5.attn           |     0.591M             |     0.152G   |
|      net_t.blocks.5.attn.qkv      |      0.444M            |      0.114G  |
|      net_t.blocks.5.attn.proj     |      0.148M            |      37.896M |
|     net_t.blocks.5.norm2          |     0.768K             |     0.493M   |
|      net_t.blocks.5.norm2.weight  |      (384,)            |              |
|      net_t.blocks.5.norm2.bias    |      (384,)            |              |
|     net_t.blocks.5.mlp            |     1.182M             |     0.303G   |
|      net_t.blocks.5.mlp.fc1       |      0.591M            |      0.152G  |
|      net_t.blocks.5.mlp.fc2       |      0.59M             |      0.152G  |
|    net_t.blocks.6                 |    1.774M              |    0.456G    |
|     net_t.blocks.6.norm1          |     0.768K             |     0.493M   |
|      net_t.blocks.6.norm1.weight  |      (384,)            |              |
|      net_t.blocks.6.norm1.bias    |      (384,)            |              |
|     net_t.blocks.6.attn           |     0.591M             |     0.152G   |
|      net_t.blocks.6.attn.qkv      |      0.444M            |      0.114G  |
|      net_t.blocks.6.attn.proj     |      0.148M            |      37.896M |
|     net_t.blocks.6.norm2          |     0.768K             |     0.493M   |
|      net_t.blocks.6.norm2.weight  |      (384,)            |              |
|      net_t.blocks.6.norm2.bias    |      (384,)            |              |
|     net_t.blocks.6.mlp            |     1.182M             |     0.303G   |
|      net_t.blocks.6.mlp.fc1       |      0.591M            |      0.152G  |
|      net_t.blocks.6.mlp.fc2       |      0.59M             |      0.152G  |
|    net_t.blocks.7                 |    1.774M              |    0.456G    |
|     net_t.blocks.7.norm1          |     0.768K             |     0.493M   |
|      net_t.blocks.7.norm1.weight  |      (384,)            |              |
|      net_t.blocks.7.norm1.bias    |      (384,)            |              |
|     net_t.blocks.7.attn           |     0.591M             |     0.152G   |
|      net_t.blocks.7.attn.qkv      |      0.444M            |      0.114G  |
|      net_t.blocks.7.attn.proj     |      0.148M            |      37.896M |
|     net_t.blocks.7.norm2          |     0.768K             |     0.493M   |
|      net_t.blocks.7.norm2.weight  |      (384,)            |              |
|      net_t.blocks.7.norm2.bias    |      (384,)            |              |
|     net_t.blocks.7.mlp            |     1.182M             |     0.303G   |
|      net_t.blocks.7.mlp.fc1       |      0.591M            |      0.152G  |
|      net_t.blocks.7.mlp.fc2       |      0.59M             |      0.152G  |
|    net_t.blocks.8                 |    1.774M              |    0.456G    |
|     net_t.blocks.8.norm1          |     0.768K             |     0.493M   |
|      net_t.blocks.8.norm1.weight  |      (384,)            |              |
|      net_t.blocks.8.norm1.bias    |      (384,)            |              |
|     net_t.blocks.8.attn           |     0.591M             |     0.152G   |
|      net_t.blocks.8.attn.qkv      |      0.444M            |      0.114G  |
|      net_t.blocks.8.attn.proj     |      0.148M            |      37.896M |
|     net_t.blocks.8.norm2          |     0.768K             |     0.493M   |
|      net_t.blocks.8.norm2.weight  |      (384,)            |              |
|      net_t.blocks.8.norm2.bias    |      (384,)            |              |
|     net_t.blocks.8.mlp            |     1.182M             |     0.303G   |
|      net_t.blocks.8.mlp.fc1       |      0.591M            |      0.152G  |
|      net_t.blocks.8.mlp.fc2       |      0.59M             |      0.152G  |
|    net_t.blocks.9                 |    1.774M              |    0.456G    |
|     net_t.blocks.9.norm1          |     0.768K             |     0.493M   |
|      net_t.blocks.9.norm1.weight  |      (384,)            |              |
|      net_t.blocks.9.norm1.bias    |      (384,)            |              |
|     net_t.blocks.9.attn           |     0.591M             |     0.152G   |
|      net_t.blocks.9.attn.qkv      |      0.444M            |      0.114G  |
|      net_t.blocks.9.attn.proj     |      0.148M            |      37.896M |
|     net_t.blocks.9.norm2          |     0.768K             |     0.493M   |
|      net_t.blocks.9.norm2.weight  |      (384,)            |              |
|      net_t.blocks.9.norm2.bias    |      (384,)            |              |
|     net_t.blocks.9.mlp            |     1.182M             |     0.303G   |
|      net_t.blocks.9.mlp.fc1       |      0.591M            |      0.152G  |
|      net_t.blocks.9.mlp.fc2       |      0.59M             |      0.152G  |
|    net_t.blocks.10                |    1.774M              |    0.456G    |
|     net_t.blocks.10.norm1         |     0.768K             |     0.493M   |
|      net_t.blocks.10.norm1.weight |      (384,)            |              |
|      net_t.blocks.10.norm1.bias   |      (384,)            |              |
|     net_t.blocks.10.attn          |     0.591M             |     0.152G   |
|      net_t.blocks.10.attn.qkv     |      0.444M            |      0.114G  |
|      net_t.blocks.10.attn.proj    |      0.148M            |      37.896M |
|     net_t.blocks.10.norm2         |     0.768K             |     0.493M   |
|      net_t.blocks.10.norm2.weight |      (384,)            |              |
|      net_t.blocks.10.norm2.bias   |      (384,)            |              |
|     net_t.blocks.10.mlp           |     1.182M             |     0.303G   |
|      net_t.blocks.10.mlp.fc1      |      0.591M            |      0.152G  |
|      net_t.blocks.10.mlp.fc2      |      0.59M             |      0.152G  |
|    net_t.blocks.11                |    1.774M              |    0.456G    |
|     net_t.blocks.11.norm1         |     0.768K             |     0.493M   |
|      net_t.blocks.11.norm1.weight |      (384,)            |              |
|      net_t.blocks.11.norm1.bias   |      (384,)            |              |
|     net_t.blocks.11.attn          |     0.591M             |     0.152G   |
|      net_t.blocks.11.attn.qkv     |      0.444M            |      0.114G  |
|      net_t.blocks.11.attn.proj    |      0.148M            |      37.896M |
|     net_t.blocks.11.norm2         |     0.768K             |     0.493M   |
|      net_t.blocks.11.norm2.weight |      (384,)            |              |
|      net_t.blocks.11.norm2.bias   |      (384,)            |              |
|     net_t.blocks.11.mlp           |     1.182M             |     0.303G   |
|      net_t.blocks.11.mlp.fc1      |      0.591M            |      0.152G  |
|      net_t.blocks.11.mlp.fc2      |      0.59M             |      0.152G  |
|   net_t.norm                      |   0.768K               |              |
|    net_t.norm.weight              |    (384,)              |              |
|    net_t.norm.bias                |    (384,)              |              |
|  net_fusion.fc                    |  0.148M                |  37.749M     |
|   net_fusion.fc.weight            |   (384, 384)           |              |
|   net_fusion.fc.bias              |   (384,)               |              |
|  net_s                            |  16.75M                |  4.086G      |
|   net_s.cls_token                 |   (1, 1, 384)          |              |
|   net_s.pos_embed                 |   (1, 256, 384)        |              |
|   net_s.patch_embed.proj          |   0.295M               |              |
|    net_s.patch_embed.proj.weight  |    (384, 3, 16, 16)    |              |
|    net_s.patch_embed.proj.bias    |    (384,)              |              |
|   net_s.blocks                    |   15.97M               |   4.086G     |
|    net_s.blocks.0                 |    1.774M              |    0.454G    |
|     net_s.blocks.0.norm1          |     0.768K             |     0.492M   |
|      net_s.blocks.0.norm1.weight  |      (384,)            |              |
|      net_s.blocks.0.norm1.bias    |      (384,)            |              |
|     net_s.blocks.0.attn           |     0.591M             |     0.151G   |
|      net_s.blocks.0.attn.qkv      |      0.444M            |      0.113G  |
|      net_s.blocks.0.attn.proj     |      0.148M            |      37.749M |
|     net_s.blocks.0.norm2          |     0.768K             |     0.492M   |
|      net_s.blocks.0.norm2.weight  |      (384,)            |              |
|      net_s.blocks.0.norm2.bias    |      (384,)            |              |
|     net_s.blocks.0.mlp            |     1.182M             |     0.302G   |
|      net_s.blocks.0.mlp.fc1       |      0.591M            |      0.151G  |
|      net_s.blocks.0.mlp.fc2       |      0.59M             |      0.151G  |
|    net_s.blocks.1                 |    1.774M              |    0.454G    |
|     net_s.blocks.1.norm1          |     0.768K             |     0.492M   |
|      net_s.blocks.1.norm1.weight  |      (384,)            |              |
|      net_s.blocks.1.norm1.bias    |      (384,)            |              |
|     net_s.blocks.1.attn           |     0.591M             |     0.151G   |
|      net_s.blocks.1.attn.qkv      |      0.444M            |      0.113G  |
|      net_s.blocks.1.attn.proj     |      0.148M            |      37.749M |
|     net_s.blocks.1.norm2          |     0.768K             |     0.492M   |
|      net_s.blocks.1.norm2.weight  |      (384,)            |              |
|      net_s.blocks.1.norm2.bias    |      (384,)            |              |
|     net_s.blocks.1.mlp            |     1.182M             |     0.302G   |
|      net_s.blocks.1.mlp.fc1       |      0.591M            |      0.151G  |
|      net_s.blocks.1.mlp.fc2       |      0.59M             |      0.151G  |
|    net_s.blocks.2                 |    1.774M              |    0.454G    |
|     net_s.blocks.2.norm1          |     0.768K             |     0.492M   |
|      net_s.blocks.2.norm1.weight  |      (384,)            |              |
|      net_s.blocks.2.norm1.bias    |      (384,)            |              |
|     net_s.blocks.2.attn           |     0.591M             |     0.151G   |
|      net_s.blocks.2.attn.qkv      |      0.444M            |      0.113G  |
|      net_s.blocks.2.attn.proj     |      0.148M            |      37.749M |
|     net_s.blocks.2.norm2          |     0.768K             |     0.492M   |
|      net_s.blocks.2.norm2.weight  |      (384,)            |              |
|      net_s.blocks.2.norm2.bias    |      (384,)            |              |
|     net_s.blocks.2.mlp            |     1.182M             |     0.302G   |
|      net_s.blocks.2.mlp.fc1       |      0.591M            |      0.151G  |
|      net_s.blocks.2.mlp.fc2       |      0.59M             |      0.151G  |
|    net_s.blocks.3                 |    1.774M              |    0.454G    |
|     net_s.blocks.3.norm1          |     0.768K             |     0.492M   |
|      net_s.blocks.3.norm1.weight  |      (384,)            |              |
|      net_s.blocks.3.norm1.bias    |      (384,)            |              |
|     net_s.blocks.3.attn           |     0.591M             |     0.151G   |
|      net_s.blocks.3.attn.qkv      |      0.444M            |      0.113G  |
|      net_s.blocks.3.attn.proj     |      0.148M            |      37.749M |
|     net_s.blocks.3.norm2          |     0.768K             |     0.492M   |
|      net_s.blocks.3.norm2.weight  |      (384,)            |              |
|      net_s.blocks.3.norm2.bias    |      (384,)            |              |
|     net_s.blocks.3.mlp            |     1.182M             |     0.302G   |
|      net_s.blocks.3.mlp.fc1       |      0.591M            |      0.151G  |
|      net_s.blocks.3.mlp.fc2       |      0.59M             |      0.151G  |
|    net_s.blocks.4                 |    1.774M              |    0.454G    |
|     net_s.blocks.4.norm1          |     0.768K             |     0.492M   |
|      net_s.blocks.4.norm1.weight  |      (384,)            |              |
|      net_s.blocks.4.norm1.bias    |      (384,)            |              |
|     net_s.blocks.4.attn           |     0.591M             |     0.151G   |
|      net_s.blocks.4.attn.qkv      |      0.444M            |      0.113G  |
|      net_s.blocks.4.attn.proj     |      0.148M            |      37.749M |
|     net_s.blocks.4.norm2          |     0.768K             |     0.492M   |
|      net_s.blocks.4.norm2.weight  |      (384,)            |              |
|      net_s.blocks.4.norm2.bias    |      (384,)            |              |
|     net_s.blocks.4.mlp            |     1.182M             |     0.302G   |
|      net_s.blocks.4.mlp.fc1       |      0.591M            |      0.151G  |
|      net_s.blocks.4.mlp.fc2       |      0.59M             |      0.151G  |
|    net_s.blocks.5                 |    1.774M              |    0.454G    |
|     net_s.blocks.5.norm1          |     0.768K             |     0.492M   |
|      net_s.blocks.5.norm1.weight  |      (384,)            |              |
|      net_s.blocks.5.norm1.bias    |      (384,)            |              |
|     net_s.blocks.5.attn           |     0.591M             |     0.151G   |
|      net_s.blocks.5.attn.qkv      |      0.444M            |      0.113G  |
|      net_s.blocks.5.attn.proj     |      0.148M            |      37.749M |
|     net_s.blocks.5.norm2          |     0.768K             |     0.492M   |
|      net_s.blocks.5.norm2.weight  |      (384,)            |              |
|      net_s.blocks.5.norm2.bias    |      (384,)            |              |
|     net_s.blocks.5.mlp            |     1.182M             |     0.302G   |
|      net_s.blocks.5.mlp.fc1       |      0.591M            |      0.151G  |
|      net_s.blocks.5.mlp.fc2       |      0.59M             |      0.151G  |
|    net_s.blocks.6                 |    1.774M              |    0.454G    |
|     net_s.blocks.6.norm1          |     0.768K             |     0.492M   |
|      net_s.blocks.6.norm1.weight  |      (384,)            |              |
|      net_s.blocks.6.norm1.bias    |      (384,)            |              |
|     net_s.blocks.6.attn           |     0.591M             |     0.151G   |
|      net_s.blocks.6.attn.qkv      |      0.444M            |      0.113G  |
|      net_s.blocks.6.attn.proj     |      0.148M            |      37.749M |
|     net_s.blocks.6.norm2          |     0.768K             |     0.492M   |
|      net_s.blocks.6.norm2.weight  |      (384,)            |              |
|      net_s.blocks.6.norm2.bias    |      (384,)            |              |
|     net_s.blocks.6.mlp            |     1.182M             |     0.302G   |
|      net_s.blocks.6.mlp.fc1       |      0.591M            |      0.151G  |
|      net_s.blocks.6.mlp.fc2       |      0.59M             |      0.151G  |
|    net_s.blocks.7                 |    1.774M              |    0.454G    |
|     net_s.blocks.7.norm1          |     0.768K             |     0.492M   |
|      net_s.blocks.7.norm1.weight  |      (384,)            |              |
|      net_s.blocks.7.norm1.bias    |      (384,)            |              |
|     net_s.blocks.7.attn           |     0.591M             |     0.151G   |
|      net_s.blocks.7.attn.qkv      |      0.444M            |      0.113G  |
|      net_s.blocks.7.attn.proj     |      0.148M            |      37.749M |
|     net_s.blocks.7.norm2          |     0.768K             |     0.492M   |
|      net_s.blocks.7.norm2.weight  |      (384,)            |              |
|      net_s.blocks.7.norm2.bias    |      (384,)            |              |
|     net_s.blocks.7.mlp            |     1.182M             |     0.302G   |
|      net_s.blocks.7.mlp.fc1       |      0.591M            |      0.151G  |
|      net_s.blocks.7.mlp.fc2       |      0.59M             |      0.151G  |
|    net_s.blocks.8                 |    1.774M              |    0.454G    |
|     net_s.blocks.8.norm1          |     0.768K             |     0.492M   |
|      net_s.blocks.8.norm1.weight  |      (384,)            |              |
|      net_s.blocks.8.norm1.bias    |      (384,)            |              |
|     net_s.blocks.8.attn           |     0.591M             |     0.151G   |
|      net_s.blocks.8.attn.qkv      |      0.444M            |      0.113G  |
|      net_s.blocks.8.attn.proj     |      0.148M            |      37.749M |
|     net_s.blocks.8.norm2          |     0.768K             |     0.492M   |
|      net_s.blocks.8.norm2.weight  |      (384,)            |              |
|      net_s.blocks.8.norm2.bias    |      (384,)            |              |
|     net_s.blocks.8.mlp            |     1.182M             |     0.302G   |
|      net_s.blocks.8.mlp.fc1       |      0.591M            |      0.151G  |
|      net_s.blocks.8.mlp.fc2       |      0.59M             |      0.151G  |
|   net_s.norm                      |   0.768K               |              |
|    net_s.norm.weight              |    (384,)              |              |
|    net_s.norm.bias                |    (384,)              |              |
|   net_s.head                      |   0.385M               |              |
|    net_s.head.weight              |    (1000, 384)         |              |
|    net_s.head.bias                |    (1000,)             |              |
-------------------------------------------------------------------------------
2025-12-09 20:50:38,359 - ==> Creating optimizer
2025-12-09 20:50:38,361 - ==> Loading dataset: DefaultAD
2025-12-09 20:50:38,391 - ==> ********** cfg ********** 
fvcore_is                            : True                                
fvcore_b                             : 1                                   
fvcore_c                             : 3                                   
epoch_full                           : 100                                 
metrics                              : ['mAUROC_sp_max', 'mAP_sp_max', 'mF1_max_sp_max', 'mAUPRO_px', 'mAUROC_px', 'mAP_px', 'mF1_max_px', 'mF1_px_0.2_0.8_0.1', 'mAcc_px_0.2_0.8_0.1', 'mIoU_px_0.2_0.8_0.1', 'mIoU_max_px']
use_adeval                           : True                                
evaluator.kwargs                     : {'metrics': ['mAUROC_sp_max', 'mAP_sp_max', 'mF1_max_sp_max', 'mAUPRO_px', 'mAUROC_px', 'mAP_px', 'mF1_max_px', 'mF1_px_0.2_0.8_0.1', 'mAcc_px_0.2_0.8_0.1', 'mIoU_px_0.2_0.8_0.1', 'mIoU_max_px'], 'pooling_ks': [16, 16], 'max_step_aupro': 100}
vis                                  : False                               
vis_dir                              : None                                
optim.lr                             : 0.0001                              
optim.kwargs                         : {'name': 'adamw', 'betas': (0.9, 0.999), 'eps': 1e-08, 'weight_decay': 0.0001, 'amsgrad': False}
trainer.name                         : ViTADTrainer                        
trainer.checkpoint                   : runs                                
trainer.logdir_sub                   :                                     
trainer.resume_dir                   :                                     
trainer.cuda_deterministic           : False                               
trainer.epoch_full                   : 100                                 
trainer.scheduler_kwargs             : {'name': 'step', 'lr_noise': None, 'noise_pct': 0.67, 'noise_std': 1.0, 'noise_seed': 42, 'lr_min': 1e-06, 'warmup_lr': 1.0000000000000001e-07, 'warmup_iters': -1, 'cooldown_iters': 0, 'warmup_epochs': 0, 'cooldown_epochs': 0, 'use_iters': True, 'patience_iters': 0, 'patience_epochs': 0, 'decay_iters': 0, 'decay_epochs': 80, 'cycle_decay': 0.1, 'decay_rate': 0.1}
trainer.mixup_kwargs                 : {'mixup_alpha': 0.8, 'cutmix_alpha': 1.0, 'cutmix_minmax': None, 'prob': 0.0, 'switch_prob': 0.5, 'mode': 'batch', 'correct_lam': True, 'label_smoothing': 0.1}
trainer.test_start_epoch             : 100                                 
trainer.test_per_epoch               : 10                                  
trainer.find_unused_parameters       : False                               
trainer.sync_BN                      : apex                                
trainer.dist_BN                      :                                     
trainer.scaler                       : none                                
trainer.data.batch_size              : 8                                   
trainer.data.batch_size_per_gpu      : 8                                   
trainer.data.batch_size_test         : 8                                   
trainer.data.batch_size_per_gpu_test : 8                                   
trainer.data.num_workers_per_gpu     : 4                                   
trainer.data.drop_last               : True                                
trainer.data.pin_memory              : True                                
trainer.data.persistent_workers      : False                               
trainer.data.num_workers             : 4                                   
trainer.iter                         : 0                                   
trainer.epoch                        : 0                                   
trainer.iter_full                    : 97600                               
trainer.metric_recorder              : {'mAUROC_sp_max_glass-insulator': [], 'mAP_sp_max_glass-insulator': [], 'mF1_max_sp_max_glass-insulator': [], 'mAUPRO_px_glass-insulator': [], 'mAUROC_px_glass-insulator': [], 'mAP_px_glass-insulator': [], 'mF1_max_px_glass-insulator': [], 'mF1_px_0.2_0.8_0.1_glass-insulator': [], 'mAcc_px_0.2_0.8_0.1_glass-insulator': [], 'mIoU_px_0.2_0.8_0.1_glass-insulator': [], 'mIoU_max_px_glass-insulator': [], 'mAUROC_sp_max_lightning-rod-suspension': [], 'mAP_sp_max_lightning-rod-suspension': [], 'mF1_max_sp_max_lightning-rod-suspension': [], 'mAUPRO_px_lightning-rod-suspension': [], 'mAUROC_px_lightning-rod-suspension': [], 'mAP_px_lightning-rod-suspension': [], 'mF1_max_px_lightning-rod-suspension': [], 'mF1_px_0.2_0.8_0.1_lightning-rod-suspension': [], 'mAcc_px_0.2_0.8_0.1_lightning-rod-suspension': [], 'mIoU_px_0.2_0.8_0.1_lightning-rod-suspension': [], 'mIoU_max_px_lightning-rod-suspension': [], 'mAUROC_sp_max_polymer-insulator-upper-shackle': [], 'mAP_sp_max_polymer-insulator-upper-shackle': [], 'mF1_max_sp_max_polymer-insulator-upper-shackle': [], 'mAUPRO_px_polymer-insulator-upper-shackle': [], 'mAUROC_px_polymer-insulator-upper-shackle': [], 'mAP_px_polymer-insulator-upper-shackle': [], 'mF1_max_px_polymer-insulator-upper-shackle': [], 'mF1_px_0.2_0.8_0.1_polymer-insulator-upper-shackle': [], 'mAcc_px_0.2_0.8_0.1_polymer-insulator-upper-shackle': [], 'mIoU_px_0.2_0.8_0.1_polymer-insulator-upper-shackle': [], 'mIoU_max_px_polymer-insulator-upper-shackle': [], 'mAUROC_sp_max_vari-grip': [], 'mAP_sp_max_vari-grip': [], 'mF1_max_sp_max_vari-grip': [], 'mAUPRO_px_vari-grip': [], 'mAUROC_px_vari-grip': [], 'mAP_px_vari-grip': [], 'mF1_max_px_vari-grip': [], 'mF1_px_0.2_0.8_0.1_vari-grip': [], 'mAcc_px_0.2_0.8_0.1_vari-grip': [], 'mIoU_px_0.2_0.8_0.1_vari-grip': [], 'mIoU_max_px_vari-grip': [], 'mAUROC_sp_max_yoke-suspension': [], 'mAUROC_sp_max_Avg': [], 'mAP_sp_max_yoke-suspension': [], 'mAP_sp_max_Avg': [], 'mF1_max_sp_max_yoke-suspension': [], 'mF1_max_sp_max_Avg': [], 'mAUPRO_px_yoke-suspension': [], 'mAUPRO_px_Avg': [], 'mAUROC_px_yoke-suspension': [], 'mAUROC_px_Avg': [], 'mAP_px_yoke-suspension': [], 'mAP_px_Avg': [], 'mF1_max_px_yoke-suspension': [], 'mF1_max_px_Avg': [], 'mF1_px_0.2_0.8_0.1_yoke-suspension': [], 'mF1_px_0.2_0.8_0.1_Avg': [], 'mAcc_px_0.2_0.8_0.1_yoke-suspension': [], 'mAcc_px_0.2_0.8_0.1_Avg': [], 'mIoU_px_0.2_0.8_0.1_yoke-suspension': [], 'mIoU_px_0.2_0.8_0.1_Avg': [], 'mIoU_max_px_yoke-suspension': [], 'mIoU_max_px_Avg': []}
loss.loss_terms                      : [{'type': 'CosLoss', 'name': 'cos', 'avg': False, 'lam': 1.0}]
loss.clip_grad                       : 5.0                                 
loss.create_graph                    : False                               
loss.retain_graph                    : False                               
adv                                  : False                               
logging.log_terms_train              : [{'name': 'batch_t', 'fmt': ':>5.3f', 'add_name': 'avg'}, {'name': 'data_t', 'fmt': ':>5.3f'}, {'name': 'optim_t', 'fmt': ':>5.3f'}, {'name': 'lr', 'fmt': ':>7.6f'}, {'name': 'cos', 'suffixes': [''], 'fmt': ':>5.3f', 'add_name': 'avg'}]
logging.log_terms_test               : [{'name': 'batch_t', 'fmt': ':>5.3f', 'add_name': 'avg'}, {'name': 'cos', 'suffixes': [''], 'fmt': ':>5.3f', 'add_name': 'avg'}]
logging.train_reset_log_per          : 50                                  
logging.train_log_per                : 50                                  
logging.test_log_per                 : 50                                  
data.sampler                         : naive                               
data.loader_type                     : pil                                 
data.loader_type_target              : pil_L                               
data.type                            : DefaultAD                           
data.root                            : data/insplad-seg                    
data.meta                            : meta.json                           
data.cls_names                       : []                                  
data.train_transforms                : [{'type': 'Resize', 'size': (256, 256), 'interpolation': <InterpolationMode.BILINEAR: 'bilinear'>}, {'type': 'CenterCrop', 'size': (256, 256)}, {'type': 'ToTensor'}, {'type': 'Normalize', 'mean': (0.485, 0.456, 0.406), 'std': (0.229, 0.224, 0.225), 'inplace': True}]
data.test_transforms                 : [{'type': 'Resize', 'size': (256, 256), 'interpolation': <InterpolationMode.BILINEAR: 'bilinear'>}, {'type': 'CenterCrop', 'size': (256, 256)}, {'type': 'ToTensor'}, {'type': 'Normalize', 'mean': (0.485, 0.456, 0.406), 'std': (0.229, 0.224, 0.225), 'inplace': True}]
data.target_transforms               : [{'type': 'Resize', 'size': (256, 256), 'interpolation': <InterpolationMode.BILINEAR: 'bilinear'>}, {'type': 'CenterCrop', 'size': (256, 256)}, {'type': 'ToTensor'}]
data.train_size                      : 976                                 
data.test_size                       : 321                                 
data.train_length                    : 7812                                
data.test_length                     : 2565                                
model_t.name                         : vit_small_patch16_224_dino          
model_t.kwargs                       : {'pretrained': True, 'checkpoint_path': '', 'pretrained_strict': False, 'strict': True, 'img_size': 256, 'teachers': [3, 6, 9], 'neck': [12]}
model_f.name                         : fusion                              
model_f.kwargs                       : {'pretrained': False, 'checkpoint_path': '', 'strict': False, 'dim': 384, 'mul': 1}
model_s.name                         : de_vit_small_patch16_224_dino       
model_s.kwargs                       : {'pretrained': False, 'checkpoint_path': '', 'strict': False, 'img_size': 256, 'students': [3, 6, 9], 'depth': 9}
model.name                           : vitad                               
model.kwargs                         : {'pretrained': False, 'checkpoint_path': '', 'strict': True, 'model_t': Namespace(name='vit_small_patch16_224_dino', kwargs={'pretrained': True, 'checkpoint_path': '', 'pretrained_strict': False, 'strict': True, 'img_size': 256, 'teachers': [3, 6, 9], 'neck': [12]}), 'model_f': Namespace(name='fusion', kwargs={'pretrained': False, 'checkpoint_path': '', 'strict': False, 'dim': 384, 'mul': 1}), 'model_s': Namespace(name='de_vit_small_patch16_224_dino', kwargs={'pretrained': False, 'checkpoint_path': '', 'strict': False, 'img_size': 256, 'students': [3, 6, 9], 'depth': 9})}
seed                                 : 42                                  
size                                 : 256                                 
warmup_epochs                        : 0                                   
test_start_epoch                     : 100                                 
test_per_epoch                       : 10                                  
batch_train                          : 8                                   
batch_test_per                       : 8                                   
lr                                   : 0.0001                              
weight_decay                         : 0.0001                              
cfg_path                             : configs.vitad.vitad_insplad         
mode                                 : train                               
sleep                                : -1                                  
memory                               : -1                                  
dist_url                             : env://                              
logger_rank                          : 0                                   
opts                                 : []                                  
command                              : python3 -m torch.distributed.launch --nproc_per_node=$nproc_per_node --nnodes=$nnodes --node_rank=$node_rank --master_addr=$master_addr --master_port=$master_port --use_env run.py -c configs.vitad.vitad_insplad -m train --sleep -1 --memory -1 --dist_url env:// --logger_rank 0 
task_start_time                      : 110707.7943165                      
dist                                 : False                               
world_size                           : 1                                   
rank                                 : 0                                   
local_rank                           : 0                                   
ngpus_per_node                       : 1                                   
nnodes                               : 1                                   
master                               : True                                
logdir                               : runs/ViTADTrainer_configs_vitad_vitad_insplad_20251209-205036
logger.filters                       : []                                  
logger.name                          : root                                
logger.level                         : 20                                  
logger.parent                        : None                                
logger.propagate                     : True                                
logger.disabled                      : False                               
logdir_train                         : runs/ViTADTrainer_configs_vitad_vitad_insplad_20251209-205036/show_train
logdir_test                          : runs/ViTADTrainer_configs_vitad_vitad_insplad_20251209-205036/show_test
2025-12-09 20:50:38,391 - ==> Starting training with 1 nodes x 1 GPUs
2025-12-09 20:50:59,009 - Train: 0.05% [50/97600]  [0.1/100.0] [batch_t 0.068 (0.076)] [data_t 0.001] [optim_t 0.067] [lr 0.000100] [cos 1.222 (1.571)]
2025-12-09 20:51:02,354 - Train: 0.10% [100/97600]  [0.1/100.0] [batch_t 0.066 (0.067)] [data_t 0.001] [optim_t 0.065] [lr 0.000100] [cos 0.906 (1.041)]
2025-12-09 20:51:05,633 - Train: 0.15% [150/97600]  [0.2/100.0] [batch_t 0.065 (0.066)] [data_t 0.001] [optim_t 0.064] [lr 0.000100] [cos 0.816 (0.851)]
2025-12-09 20:51:08,908 - Train: 0.20% [200/97600]  [0.2/100.0] [batch_t 0.065 (0.065)] [data_t 0.001] [optim_t 0.064] [lr 0.000100] [cos 0.683 (0.759)]
2025-12-09 20:51:12,185 - Train: 0.26% [250/97600]  [0.3/100.0] [batch_t 0.065 (0.065)] [data_t 0.001] [optim_t 0.064] [lr 0.000100] [cos 0.660 (0.699)]
2025-12-09 20:51:15,471 - Train: 0.31% [300/97600]  [0.3/100.0] [batch_t 0.065 (0.066)] [data_t 0.001] [optim_t 0.064] [lr 0.000100] [cos 0.667 (0.660)]
2025-12-09 20:51:18,756 - Train: 0.36% [350/97600]  [0.4/100.0] [batch_t 0.065 (0.066)] [data_t 0.001] [optim_t 0.064] [lr 0.000100] [cos 0.615 (0.625)]
2025-12-09 20:51:22,052 - Train: 0.41% [400/97600]  [0.4/100.0] [batch_t 0.065 (0.066)] [data_t 0.001] [optim_t 0.064] [lr 0.000100] [cos 0.596 (0.597)]
2025-12-09 20:51:25,346 - Train: 0.46% [450/97600]  [0.5/100.0] [batch_t 0.066 (0.066)] [data_t 0.001] [optim_t 0.065] [lr 0.000100] [cos 0.572 (0.576)]
2025-12-09 20:51:28,656 - Train: 0.51% [500/97600]  [0.5/100.0] [batch_t 0.066 (0.066)] [data_t 0.001] [optim_t 0.065] [lr 0.000100] [cos 0.556 (0.552)]
2025-12-09 20:51:31,959 - Train: 0.56% [550/97600]  [0.6/100.0] [batch_t 0.065 (0.066)] [data_t 0.001] [optim_t 0.064] [lr 0.000100] [cos 0.590 (0.542)]
2025-12-09 20:51:35,279 - Train: 0.61% [600/97600]  [0.6/100.0] [batch_t 0.066 (0.066)] [data_t 0.001] [optim_t 0.065] [lr 0.000100] [cos 0.536 (0.517)]
2025-12-09 20:51:38,611 - Train: 0.67% [650/97600]  [0.7/100.0] [batch_t 0.067 (0.067)] [data_t 0.001] [optim_t 0.065] [lr 0.000100] [cos 0.522 (0.511)]
2025-12-09 20:51:41,934 - Train: 0.72% [700/97600]  [0.7/100.0] [batch_t 0.067 (0.066)] [data_t 0.001] [optim_t 0.066] [lr 0.000100] [cos 0.528 (0.499)]
2025-12-09 20:51:45,257 - Train: 0.77% [750/97600]  [0.8/100.0] [batch_t 0.066 (0.066)] [data_t 0.001] [optim_t 0.065] [lr 0.000100] [cos 0.469 (0.486)]
